<div class="background pb-3" style=" margin-left: 6%;
    width: 90%;">
  <div>
    <a class="navbar-brand mt-4" style="font-family: none; font-weight: 900; color: black;">
      <h1 class="text-center pt-5">Offers</h1>
    </a>
  </div>
  <div class="d-flex" style="margin-left:9%;">

    <div class="col-4 me-5" style="width:43%;">
      <div class="d-flex mb-2">
        <h4 class=""><strong>Product Offer</strong></h4>
        <button type="button" class="btn btn-outline-secondary ms-auto" data-bs-toggle="modal"
          data-bs-target="#product-offer" data-bs-whatever=" @mdo"><i class="fa-solid fa-plus"></i>&nbsp; Add
          Product
          Offer</button>
      </div>
      <table class="table table-bordered" style="">
        <thead class="table-dark">
          <tr>
            <th scope="col" class="text-center">Product</th>
            <th scope="col" class="text-center">Offer in %</th>
            <th scope="col" class="text-center">Action</th>
          </tr>
        </thead>
        <tbody>
          {{#each products}}
          <tr>
            <td class="text-center">{{this.Name}}</td>
            <td class="text-center">{{this.offer}}%</td>
            <td class="text-center">
              {{!-- <button type="button" style="border:0;" onclick="deleteProductOffer('{{this._id}}')"><i
                  class="bi bi-trash" style="color: red; font-size:20px;"></i></button> --}}

              {{!-- <button type="button" onclick="deleteProductOffer('{{this._id}}')" style="color: red;border:0;"><svg
                  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash"
                  viewBox="0 0 16 16">
                  <path
                    d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                  <path fill-rule="evenodd"
                    d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                </svg></button> --}}
              <a href="/admin/delete-product-offer?id={{this._id}}" type="button" class="btn btn-danger"><svg
                  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash"
                  viewBox="0 0 16 16">
                  <path
                    d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                  <path fill-rule="evenodd"
                    d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                </svg></a>


            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>


    <div class="col-4 me-5" style="width:43%;">
      <div class="d-flex mb-2">
        <h4 class=""><strong>Category Offer</strong></h4>
        <button type="button" class="btn btn-outline-secondary ms-auto" data-bs-toggle="modal"
          data-bs-target="#category-offer" data-bs-whatever=" @mdo"><i class="fa-solid fa-plus"></i>&nbsp; Add
          Category
          Offer</button>
      </div>
      <table class="table table-bordered" style="">
        <thead class="table-dark">
          <tr>
            <th scope="col" class="text-center">Category</th>
            <th scope="col" class="text-center">Offer in %</th>
            <th scope="col" class="text-center">Action</th>
          </tr>
        </thead>
        <tbody>
          {{#each category}}
          <tr>
            <td class="text-center">{{this.Name}}</td>

            <td class="text-center">{{this.categoryDiscount}}%</td>

            <td class="text-center">
              {{!--
              <button type="button" onclick="deleteCategoryOffer('{{this._id}}')" style="color: red;border:0;"><svg
                  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash"
                  viewBox="0 0 16 16">
                  <path
                    d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                  <path fill-rule="evenodd"
                    d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                </svg></button> --}}
              <a href="/admin/delete-category-offer?id={{this._id}}" class="btn btn-danger"><svg
                  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash"
                  viewBox="0 0 16 16">
                  <path
                    d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                  <path fill-rule="evenodd"
                    d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                </svg></a>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </div>
</div>

{{!--ProductModal --}}
<div class="modal fade" id="product-offer" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Product Offer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form action="/admin/addProductOffer?id={{products._id}}" id="product-offer" method="post"
          class="needs-validation" novalidate>
          <div class=" mb-3">
            <select class="form-select" id="product-offer" name="id" required>
              <option selected>Choose the Product</option>
              {{#each products}}
              <option value="{{this._id}}">{{this.Name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="mb-3">
            <input type="number" class="form-control" aria-label="Sizing example input"
              aria-describedby="inputGroup-sizing-default" id="product-offer" name="Offer"
              placeholder="Enter Offer in Percentage" required>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Confirm</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{{!--CategoryModal--}}
<div class="modal fade" id="category-offer" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Category Offer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form action="/admin/addCategoryOffer" method="post" class="needs-validation" novalidate>
          <div class="mb-3">
            <select class="form-select" id="category-offer" name="Name">
              <option selected>Choose the Category</option>
              {{#each category}}
              <option value="{{this.Name}}">{{this.Name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="mb-3">
            <input type="number" class="form-control" aria-label="Sizing example input"
              aria-describedby="inputGroup-sizing-default" id="category-offer" name="Offer"
              placeholder="Enter Offer in Percentage" required>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Confirm</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<script>
  //DELETE PRODUCT OFFER
  function deleteProductOffer(prodId) {
    $.ajax({
      url: '/delete-product-offer/' + prodId,
      type: 'post',
      success: (response) => {
        swal({
          title: "Are you sure?",
          type: "warning",
          showCancelButton: true,
          confirmButtonColor: "red",
          confirmButtonText: "Yes",
          cancelButtonText: "No",
          closeOnConfirm: false,
          closeOnCancel: true
        },
          function (isConfirm) {
            if (isConfirm) {
              { { !--location.reload() --} }
            }
          }
        )
      }
    })
  }


  //DELETE CATEGORY OFFER
  function deleteCategoryOffer(category) {
    $.ajax({
      url: '/admin/offer-management/delete-category-offer/',
      type: 'post',
      data: ({ category }),
      success: (response) => {
        swal({
          title: "Are you sure?",
          type: "warning",
          showCancelButton: true,
          confirmButtonColor: "red",
          confirmButtonText: "Yes",
          cancelButtonText: "No",
          closeOnConfirm: false,
          closeOnCancel: true
        },
          function (isConfirm) {
            if (isConfirm) {
              location.reload()
            }
          }
        )
      }
    })
  }
</script>